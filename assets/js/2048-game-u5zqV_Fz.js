import{r as c,u as z,j as t}from"./vendor-react-BnsUgT_O.js";const R=()=>{const y=c.useRef(null),w=c.useRef(null),[i,h]=c.useState({board:Array(4).fill(null).map(()=>Array(4).fill(0)),score:0,history:[]}),d=z(),[j,v]=c.useState(null),[p,A]=c.useState(400),N=c.useCallback(()=>{if(w.current){const a=w.current.clientWidth,e=Math.min(a-32,600);A(e)}},[]);c.useEffect(()=>(N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)),[N]);const C=c.useCallback(a=>({2:"#eee4da",4:"#ede0c8",8:"#f2b179",16:"#f59563",32:"#f67c5f",64:"#f65e3b",128:"#edcf72",256:"#edcc61",512:"#edc850",1024:"#edc53f",2048:"#edc22e"})[a]||"#cdc1b4",[]),E=c.useCallback(()=>{const a=y.current;if(!a)return;const e=a.getContext("2d");if(!e)return;a.style.width=`${p}px`,a.style.height=`${p}px`,a.width=p,a.height=p;const s=(p-50)/4,o=10;e.fillStyle="#bbada0",e.fillRect(0,0,p,p);for(let f=0;f<4;f++)for(let m=0;m<4;m++){const n=m*(s+o)+o,x=f*(s+o)+o,r=i.board[f][m];if(e.fillStyle=C(r),e.fillRect(n,x,s,s),r!==0){e.fillStyle=r<=4?"#776e65":"#f9f6f2";const l=r>=1024?s*.3:s*.4;e.font=`bold ${l}px Arial`,e.textAlign="center",e.textBaseline="middle",e.fillText(r.toString(),n+s/2,x+s/2)}}},[i.board,C,p]),S=c.useCallback(()=>{const a=Array(4).fill(null).map(()=>Array(4).fill(0));k(a),k(a),h({board:a,score:0,history:[]})},[]),k=a=>{const e=[];for(let s=0;s<4;s++)for(let o=0;o<4;o++)a[s][o]===0&&e.push({x:s,y:o});if(e.length>0){const s=e[Math.floor(Math.random()*e.length)];a[s.x][s.y]=Math.random()<.9?2:4}},g=c.useCallback(a=>{const e=JSON.parse(JSON.stringify(i.board));let s=!1,o=i.score;const f=n=>{for(let x=0;x<4;x++){let r=n[x].filter(l=>l!==0);for(let l=0;l<r.length-1;l++)r[l]===r[l+1]&&(r[l]*=2,o+=r[l],r.splice(l+1,1));for(;r.length<4;)r.push(0);JSON.stringify(n[x])!==JSON.stringify(r)&&(s=!0),n[x]=r}},m=(n,x)=>{const r=n.length;for(let l=0;l<x;l++){for(let u=0;u<r;u++)for(let b=u+1;b<r;b++)[n[u][b],n[b][u]]=[n[b][u],n[u][b]];for(let u=0;u<r;u++)n[u].reverse()}};switch(a){case"left":f(e);break;case"right":m(e,2),f(e),m(e,2);break;case"down":m(e,1),f(e),m(e,3);break;case"up":m(e,3),f(e),m(e,1);break}s&&(k(e),h(n=>({board:e,score:o,history:[...n.history,{board:n.board,score:n.score}]})))},[i]);c.useEffect(()=>{const a=e=>{if(e.key.startsWith("Arrow"))switch(e.preventDefault(),e.key){case"ArrowUp":g("up");break;case"ArrowDown":g("down");break;case"ArrowLeft":g("left");break;case"ArrowRight":g("right");break}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[g]);const T=a=>{const e=a.touches[0];v({x:e.clientX,y:e.clientY})},M=a=>{if(!j)return;const e=a.changedTouches[0],s=e.clientX-j.x,o=e.clientY-j.y,f=50;Math.abs(s)>Math.abs(o)?Math.abs(s)>f&&g(s>0?"right":"left"):Math.abs(o)>f&&g(o>0?"down":"up"),v(null)},O=c.useCallback(()=>{const a=i.board;for(let e=0;e<4;e++)for(let s=0;s<4;s++)if(a[e][s]===0)return!1;for(let e=0;e<4;e++)for(let s=0;s<3;s++)if(a[e][s]===a[e][s+1]||a[s][e]===a[s+1][e])return!1;return!0},[i.board]);return c.useEffect(()=>{if(O()){const e={playerName:prompt("Game Over! Your score: "+i.score+`
Enter your name:`)||"Anonymous",score:i.score,date:new Date().toLocaleDateString()},s=JSON.parse(localStorage.getItem("gameScores")||"[]");localStorage.setItem("gameScores",JSON.stringify([...s,e])),window.confirm("Start a new game?")&&S()}},[i.score,O,S]),c.useEffect(()=>{S()},[S]),c.useEffect(()=>{E()},[E]),t.jsxs("div",{className:"game-container",ref:w,children:[t.jsxs("div",{className:"game-header",children:[t.jsx("h1",{children:"2048"}),t.jsxs("div",{className:"score-container",children:[t.jsx("div",{children:"Score"}),t.jsx("div",{children:i.score})]})]}),t.jsxs("div",{className:"game-controls",children:[t.jsx("button",{onClick:S,children:"New Game"}),t.jsx("button",{onClick:()=>d("/2048/history"),children:"History"}),t.jsx("button",{onClick:()=>d("/"),children:"Back to Home"})]}),t.jsx("canvas",{ref:y,onTouchStart:T,onTouchEnd:M,className:"game-canvas"})]})},G=Object.freeze(Object.defineProperty({__proto__:null,default:R},Symbol.toStringTag,{value:"Module"})),_=()=>{const[y,w]=c.useState([]),i=z();return c.useEffect(()=>{const d=JSON.parse(localStorage.getItem("gameScores")||"[]").sort((j,v)=>v.score-j.score);w(d)},[]),t.jsxs("div",{className:"container mx-auto p-4 sm:p-8",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8",children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-4 sm:mb-0",children:"2048 Score History"}),t.jsx("button",{onClick:()=>i("/2048"),className:"w-full sm:w-auto px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Game"})]}),t.jsxs("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:[y.length===0?t.jsx("div",{className:"p-6 text-center text-gray-500",children:"No scores yet. Play a game to set some records!"}):t.jsx("div",{className:"block sm:hidden",children:y.map((h,d)=>t.jsxs("div",{className:`p-4 border-b ${d<3?"bg-yellow-50":""}`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("span",{className:"font-bold text-lg",children:["#",d+1]}),t.jsx("span",{className:"text-xl font-bold text-blue-600",children:h.score})]}),t.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[t.jsx("span",{children:h.playerName}),t.jsx("span",{children:h.date})]})]},d))}),y.length>0&&t.jsxs("table",{className:"hidden sm:table w-full",children:[t.jsx("thead",{className:"bg-gray-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rank"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Player Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),t.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map((h,d)=>t.jsxs("tr",{className:d<3?"bg-yellow-50":"",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d+1}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.playerName}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.score}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:h.date})]},d))})]})]})]})},J=Object.freeze(Object.defineProperty({__proto__:null,default:_},Symbol.toStringTag,{value:"Module"}));export{J as h,G as i};
//# sourceMappingURL=2048-game-u5zqV_Fz.js.map
