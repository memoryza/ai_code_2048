import{r as h,u as R,j as n}from"./vendor-react-BnsUgT_O.js";const a=20,w=28,g=21,I=150,C=[["WWWWWWWWWWWWWWWWWWWWWWWWWWWW","W............WW............W","W.WWWW.WWWW.WW.WWWW.WWWW.W","W.WWWW.WWWW.WW.WWWW.WWWW.W","W.........................W","W.WWWW.WW.WWWWWW.WW.WWWW.W","W......WW....WW....WW.....W","WWWWWW.WWWWW.WW.WWWWW.WWWW","W......WW.........WW......W","W.WWWW.WW.WW--WW.WW.WWWW.W","W.WWWW....W    W....WWWW.W","W.WWWW.WW.WWWWWW.WW.WWWW.W","W......WW........WW......W","WWWWWW.WW.WWWWWW.WW.WWWWW","     W....W    W....W     ","WWWWWW.WW.W    W.WW.WWWWW","W............WW...........W","W.WWWW.WWWW.WW.WWWW.WWWW.W","W...WW................WW..W","WWW.WW.WW.WWWWWW.WW.WW.WWW","W......WW....WW....WW.....W","W.WWWWWWWWWW.WW.WWWWWWWW.W","W.........................W","WWWWWWWWWWWWWWWWWWWWWWWWWWW"],["WWWWWWWWWWWWWWWWWWWWWWWWWWWW","W.........................W","W.WWWW.WWWWW.WW.WWWWW.WW.W","W.WWWW.WWWWW.WW.WWWWW.WW.W","W......WW.....WW.........W","WWWWWW.WW.WWW.WW.WWW.WWWWW","W......WW.WWW.WW.WWW.....W","W.WWWW.WW.WWW.WW.WWW.WWWW","W.WWWW...................W","W......WW.WWWWWW.WW.....W","WWWWWW.WW....WW....WWWWWW","W......WW.WW.WW.WW......W","W.WWWW.WW.WW.WW.WW.WWWW.W","W.WWWW....WW.WW....WWWW.W","W......WW.WW.WW.WW......W","WWWWWW.WW....WW....WWWWWW","W......WW.WWWWWW.WW.....W","W.WWWW...................W","W.WWWW.WW.WWW.WW.WWW.WWWW","W......WW.WWW.WW.WWW.....W","WWWWWW.WW.WWW.WW.WWW.WWWWW","W......WW.....WW.........W","W.........................W","WWWWWWWWWWWWWWWWWWWWWWWWWWW"]],Y=()=>{const M=h.useRef(null),[r,S]=h.useState({board:[],pacman:{position:{x:14,y:23},direction:"right"},ghosts:[{position:{x:13,y:14},direction:"right",color:"#ff0000"},{position:{x:16,y:14},direction:"left",color:"#00ffff"}],score:0,gameOver:!1}),b=R();h.useRef();const v=h.useRef(0),[P,D]=h.useState("right"),[j,p]=h.useState("right"),[u,y]=h.useState(!1),_=t=>{let W=!1;const e=Array(g).fill(0).map(()=>Array(w).fill(!1)),l=[];let d=null;for(let o=0;o<g;o++)for(let s=0;s<w;s++)t[o][s]==="dot"&&(W=!0),t[o][s]!=="wall"&&!d&&(d={x:s,y:o},l.push({x:s,y:o}),e[o][s]=!0);if(!W||!d)return!1;const m=[[-1,0],[1,0],[0,-1],[0,1]];for(;l.length>0;){const o=l.shift();for(const[s,i]of m){const c=o.x+s,f=o.y+i;c>=0&&c<w&&f>=0&&f<g&&!e[f][c]&&t[f][c]!=="wall"&&(l.push({x:c,y:f}),e[f][c]=!0)}}for(let o=0;o<g;o++)for(let s=0;s<w;s++)if(t[o][s]==="dot"&&!e[o][s])return!1;return!0},N=h.useCallback(()=>{let t=!1,W=[],e=[];for(;!t;)e=C[Math.floor(Math.random()*C.length)],W=e.map(s=>s.split("").map(i=>i==="."?"dot":i==="W"?"wall":"empty")),t=_(W);let l={x:14,y:g-2};for(;W[l.y][l.x]==="wall";)l.y--,l.y<0&&(l={x:Math.floor(w/2),y:g-2});const d=()=>{let s={x:Math.floor(w/2),y:Math.floor(g/2)};for(;W[s.y][s.x]==="wall";)s.x=Math.floor(Math.random()*(w-2))+1,s.y=Math.floor(g/2);return s},m=d(),o=d();S({board:W,pacman:{position:l,direction:"right"},ghosts:[{position:m,direction:"right",color:"#ff0000"},{position:o,direction:"left",color:"#00ffff"}],score:0,gameOver:!1}),D("right"),p("right"),v.current=Date.now()},[]),k=h.useCallback((t,W)=>{const e={...t};switch(W){case"up":e.y-=1;break;case"down":e.y+=1;break;case"left":e.x-=1;break;case"right":e.x+=1;break}return e.x<0||e.x>=w||e.y<0||e.y>=g?!1:r.board[e.y][e.x]!=="wall"},[r.board]),O=h.useCallback((t,W)=>{let e={...t};switch(W){case"up":e.y=(e.y-1+g)%g;break;case"down":e.y=(e.y+1)%g;break;case"left":e.x=(e.x-1+w)%w;break;case"right":e.x=(e.x+1)%w;break}return r.board[e.y][e.x]==="wall"?t:e},[r.board]);h.useCallback(t=>{if(!r.gameOver)switch(t.key){case"ArrowUp":case"w":case"W":p("up"),u||y(!0);break;case"ArrowDown":case"s":case"S":p("down"),u||y(!0);break;case"ArrowLeft":case"a":case"A":p("left"),u||y(!0);break;case"ArrowRight":case"d":case"D":p("right"),u||y(!0);break}},[r.gameOver,u]);const F=h.useCallback(t=>{if(r.gameOver)return;const W=t.touches[0],e=M.current;if(!e)return;const l=e.getBoundingClientRect(),d=W.clientX-l.left,m=W.clientY-l.top,o=e.width/2,s=e.height/2,i=d-o,c=m-s;let f;Math.abs(i)>Math.abs(c)?f=i>0?"right":"left":f=c>0?"down":"up",p(f),u||y(!0)},[r.gameOver,u]),H=h.useCallback(t=>{if(!touchStart||r.gameOver)return;const W=t.touches[0],e=W.clientX-touchStart.x,l=W.clientY-touchStart.y;(Math.abs(e)>30||Math.abs(l)>30)&&(Math.abs(e)>Math.abs(l)?p(e>0?"right":"left"):p(l>0?"down":"up"),u||y(!0),setTouchStart(null))},[r.gameOver,u]),G=h.useCallback(()=>{setTouchStart(null)},[]),E=h.useCallback(()=>{if(!r.gameOver&&u){const t=Date.now();t-v.current>=I&&S(e=>{if(!e.pacman)return e;const l=k(e.pacman.position,j),d=k(e.pacman.position,P),m=l?j:d?P:e.pacman.direction,o=O(e.pacman.position,m);let s=e.score;const i=[...e.board];i[o.y][o.x]==="dot"&&(i[o.y][o.x]="empty",s+=10);const c=e.ghosts.map(x=>{const L=O(x.position,x.direction);if(Math.random()<.1){const A=["up","down","left","right"].filter(X=>k(x.position,X));A.length>0&&(x.direction=A[Math.floor(Math.random()*A.length)])}return{...x,position:L}});if(c.some(x=>x.position.x===o.x&&x.position.y===o.y)){const x=JSON.parse(localStorage.getItem("pacmanHistory")||"[]");return x.push({score:s,date:new Date().toLocaleString()}),localStorage.setItem("pacmanHistory",JSON.stringify(x)),{...e,gameOver:!0}}return v.current=t,D(m),{...e,board:i,score:s,pacman:{position:o,direction:m},ghosts:c}})}},[r.gameOver,j,P,k,O,u]),T=h.useCallback(()=>{const t=M.current,W=t==null?void 0:t.getContext("2d");if(!t||!W)return;W.clearRect(0,0,t.width,t.height),r.board.forEach((s,i)=>{s.forEach((c,f)=>{c==="wall"?(W.fillStyle="#2121DE",W.fillRect(f*a,i*a,a,a)):c==="dot"&&(W.fillStyle="#FFFF00",W.beginPath(),W.arc(f*a+a/2,i*a+a/2,a/8,0,Math.PI*2),W.fill())})}),W.fillStyle="#FFFF00",W.beginPath();const e=r.pacman.position.x*a+a/2,l=r.pacman.position.y*a+a/2,d=.2*Math.PI;let m=0,o=2*Math.PI;switch(r.pacman.direction){case"right":m=d,o=2*Math.PI-d;break;case"left":m=Math.PI+d,o=Math.PI-d;break;case"up":m=Math.PI*1.5+d,o=Math.PI*1.5-d;break;case"down":m=Math.PI*.5+d,o=Math.PI*.5-d;break}W.arc(e,l,a/2,m,o),W.lineTo(e,l),W.fill(),r.ghosts.forEach(s=>{W.fillStyle=s.color,W.beginPath();const i=s.position.x*a+a/2,c=s.position.y*a+a/2;W.arc(i,c-a/4,a/2,Math.PI,0,!1),W.lineTo(i+a/2,c+a/4);for(let f=0;f<3;f++){const x=a/6;W.quadraticCurveTo(i+a/2-x*(2-f),c+a/4+x,i+a/2-x*(3-f),c+a/4)}W.lineTo(i-a/2,c+a/4),W.fill(),W.fillStyle="white",W.beginPath(),W.arc(i-a/4,c-a/4,a/6,0,Math.PI*2),W.arc(i+a/4,c-a/4,a/6,0,Math.PI*2),W.fill(),W.fillStyle="blue",W.beginPath(),W.arc(i-a/4,c-a/4,a/10,0,Math.PI*2),W.arc(i+a/4,c-a/4,a/10,0,Math.PI*2),W.fill()}),r.gameOver&&(W.fillStyle="rgba(0, 0, 0, 0.7)",W.fillRect(0,0,t.width,t.height),W.font="48px Arial",W.fillStyle="white",W.textAlign="center",W.textBaseline="middle",W.fillText("Game Over!",t.width/2,t.height/2-30),W.font="24px Arial",W.fillText(`Score: ${r.score}`,t.width/2,t.height/2+30))},[r]);return h.useEffect(()=>{const t=W=>{if(!r.gameOver)switch(W.key){case"ArrowUp":case"w":case"W":p("up"),u||y(!0);break;case"ArrowDown":case"s":case"S":p("down"),u||y(!0);break;case"ArrowLeft":case"a":case"A":p("left"),u||y(!0);break;case"ArrowRight":case"d":case"D":p("right"),u||y(!0);break}};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[r.gameOver,u]),h.useEffect(()=>{const t=M.current;t&&(t.width=w*a,t.height=g*a),N()},[N]),h.useEffect(()=>{let t;const W=()=>{if(!r.gameOver&&u){const e=Date.now();e-v.current>=I&&(E(),v.current=e)}T(),t=requestAnimationFrame(W)};return t=requestAnimationFrame(W),()=>cancelAnimationFrame(t)},[E,T,r,u]),n.jsxs("div",{className:"pacman-container",children:[n.jsxs("div",{className:"game-header",children:[n.jsx("h1",{children:"Pacman"}),n.jsx("div",{className:"score-container",children:n.jsxs("div",{className:"score-box",children:["Score: ",r.score]})})]}),n.jsxs("div",{className:"game-area",children:[n.jsx("canvas",{ref:M,className:"game-canvas",onTouchStart:F,onTouchMove:H,onTouchEnd:G}),r.gameOver&&n.jsxs("div",{className:"game-over",children:[n.jsx("h2",{children:"Game Over!"}),n.jsxs("p",{children:["Score: ",r.score]})]})]}),n.jsxs("div",{className:"game-controls",children:[n.jsx("button",{onClick:()=>{N(),y(!1)},children:"New Game"}),n.jsx("button",{onClick:()=>b("/pacman/history"),children:"History"}),n.jsx("button",{onClick:()=>b("/"),children:"Back to Home"})]})]})},z=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"})),B=()=>{const[M,r]=h.useState([]),S=R();return h.useEffect(()=>{const b=localStorage.getItem("pacmanHistory");b&&r(JSON.parse(b))},[]),n.jsx("div",{className:"min-h-screen bg-black py-8 px-4 text-white",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"flex justify-between items-center mb-8",children:[n.jsx("h1",{className:"text-3xl font-bold",children:"Pacman History"}),n.jsx("button",{onClick:()=>S("/pacman"),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-500",children:"Back to Game"})]}),n.jsx("div",{className:"bg-gray-800 rounded-lg shadow overflow-hidden",children:n.jsxs("table",{className:"min-w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b border-gray-700",children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Date"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Score"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-700",children:M.map((b,v)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:b.date}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:b.score})]},v))})]})})]})})},J=Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}));export{J as h,z as i};
//# sourceMappingURL=pacman-game-Br5YcD0R.js.map
